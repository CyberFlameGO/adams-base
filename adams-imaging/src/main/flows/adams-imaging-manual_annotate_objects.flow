# Project: adams
# Date: 2017-07-02 11:52:41
# User: fracpete
# Charset: UTF-8
adams.flow.control.Flow -annotation "Allows the user to manually annotate objects in images.\\n\\\".report\\\" files get stored alongside the images, containing the\\nobjects\\\' positions and type.\\nCan be run multiple times, as it loads the annotations from \\nexisting report files.\\nHolding down <ctrl> allows you to remove a selection, by \\neither clicking in the box (\\\"fixed_width_box\\\") or drawing a\\nlarger box around the existing one (\\\"user_drawn_box\\\")." -error-handling ACTORS_DECIDE_TO_STOP_ON_ERROR -flow-execution-listener adams.flow.execution.NullListener
 adams.flow.standalone.CallableActors
  adams.flow.sink.ProgressBar -writer adams.gui.print.NullWriter -max @{max}
  adams.flow.source.SequenceSource -name "load report"
   adams.flow.source.Variable -var-name reportfile -conversion adams.data.conversion.StringToString
   adams.flow.transformer.ReportFileReader -reader adams.data.io.input.DefaultSimpleReportReader
 adams.flow.source.Start
 adams.flow.control.Trigger -name "prompt user"
  adams.flow.source.EnterManyValues -stop-if-canceled true -value "adams.flow.source.valuedefinition.DefaultValueDefinition -name image_dir -display \"Image directory\" -help \"Directory with images to annotate\" -type DIRECTORY_ABSOLUTE -default-value ${CWD}" -value "adams.flow.source.valuedefinition.DefaultValueDefinition -name selection_type -display \"Selection type\" -help \"How to annotate the images: fixed box around left-click or user-drawn box\" -type COMMA_SEPARATED_LIST_FIXED -default-value fixed_bounding_box,user_drawn_box" -value "adams.flow.source.valuedefinition.DefaultValueDefinition -name fixed_width -display \"Fixed box width\" -help \"The width when using a fixed width box approach\" -type INTEGER -default-value 20" -value "adams.flow.source.valuedefinition.DefaultValueDefinition -name fixed_height -display \"Fixed box height\" -help \"The height when using a fixed width box approach\" -type INTEGER -default-value 20" -output-type MAP
  adams.flow.transformer.MapToVariables
 adams.flow.control.Trigger -name "process images"
  adams.flow.standalone.SetVariable -name "reset count" -var-name count -var-value 0
  adams.flow.source.FileSystemSearch -output-array true -search "adams.flow.source.filesystemsearch.LocalFileSearch -directory @{image_dir} -regexp .*\\\\.([jJ][pP][eE]?[gG]|[pP][nN][gG]) -sorting SORT_BY_NAME"
  adams.flow.control.Tee -name "# images"
   adams.flow.transformer.ArrayLength
   adams.flow.transformer.SetVariable -var-name max
  adams.flow.transformer.ArrayToSequence
  adams.flow.control.Tee -name progress
   adams.flow.transformer.IncVariable -var-name count -output-variable-value true
   adams.flow.sink.CallableSink -callable ProgressBar
  adams.flow.control.Tee -name "report file"
   adams.flow.transformer.Convert -conversion "adams.data.conversion.ReplaceFileExtension -extension .report"
   adams.flow.transformer.SetVariable -var-name reportfile
  adams.flow.transformer.ImageReader -reader adams.data.io.input.JAIImageReader
  adams.flow.control.ConditionalSubProcess -name "existing report?" -condition "adams.flow.condition.bool.FileExists -file @{reportfile} -generator adams.core.io.NullFilenameGenerator"
   adams.flow.transformer.MergeReport -source "load report" -merge MERGE_OTHER_WITH_CURRENT
  adams.flow.control.Switch -condition "adams.flow.condition.bool.Expression -expression \"\\\\\\\"@{selection_type}\\\\\\\" = \\\\\\\"user_drawn_box\\\\\\\"\"" -condition "adams.flow.condition.bool.Expression -expression \"\\\\\\\"@{selection_type}\\\\\\\" = \\\\\\\"fixed_bounding_box\\\\\\\"\"" -condition adams.flow.condition.bool.True -case adams.flow.sink.Null
   adams.flow.control.Inspect -name "manual box" -width 1200 -height 800 -provider "adams.flow.sink.ImageViewer -writer adams.gui.print.NullWriter -show-properties true -properties-width 250 -selection-processor adams.gui.visualization.image.selection.SelectObjects -left-click-processor adams.gui.visualization.image.leftclick.NullProcessor -selection-box-color #ff9900 -image-overlay adams.gui.visualization.image.ObjectLocationsOverlayFromReport"
   adams.flow.control.Inspect -name "fixed box" -width 1200 -height 800 -provider "adams.flow.sink.ImageViewer -writer adams.gui.print.NullWriter -show-properties true -properties-width 250 -selection-processor adams.gui.visualization.image.selection.NullProcessor -left-click-processor \"adams.gui.visualization.image.leftclick.FixedBoundingBox -width @{fixed_width} -height @{fixed_height}\" -image-overlay adams.gui.visualization.image.ObjectLocationsOverlayFromReport"
   adams.flow.control.Stop -stop-msg "Unknonwn selection type: @{selection_type}"
  adams.flow.transformer.ReportFileWriter -writer adams.data.io.output.DefaultSimpleReportWriter -generator "adams.core.io.SimpleFixedFilenameGenerator -name @{reportfile}"