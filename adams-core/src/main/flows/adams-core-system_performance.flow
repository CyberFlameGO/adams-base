# Project: adams
# Date: 2015-05-28 15:52:18
# User: fracpete
#
adams.flow.control.Flow
	-annotation
	Uses flow components to give an overview of the system\'s performance.
	-actor
		adams.flow.standalone.GridView
			-name
			System performance
			-short-title
			true
			-x
			-2
			-y
			-2
			-actor
				adams.flow.sink.SequencePlotter
					-name
					CPU
					-writer
						adams.gui.print.NullWriter
					-paintlet
						adams.gui.visualization.sequence.CirclePaintlet
					-overlay-paintlet
						adams.gui.visualization.sequence.LOWESSOverlayPaintlet
							-color
							#ff0000
							-window
							50
					-marker-paintlet
						adams.flow.sink.sequenceplotter.NoMarkers
					-error-paintlet
						adams.flow.sink.sequenceplotter.NoErrorPaintlet
					-mouse-click-action
						adams.flow.sink.sequenceplotter.NullClickAction
					-color-provider
						adams.gui.visualization.core.DefaultColorProvider
					-overlay-color-provider
						adams.gui.visualization.core.DefaultColorProvider
					-title
					CPU
					-axis-x
						adams.gui.visualization.core.AxisPanelOptions
							-label
							evaluations
							-tick-generator
								adams.gui.visualization.core.axis.FancyTickGenerator
							-nth-value
							2
							-width
							40
							-custom-format
							0
					-axis-y
						adams.gui.visualization.core.AxisPanelOptions
							-label
							msec
							-tick-generator
								adams.gui.visualization.core.axis.FancyTickGenerator
							-nth-value
							2
							-width
							60
							-top-margin
							0.05
							-bottom-margin
							0.05
							-custom-format
							0
					-plot-updater
						adams.flow.sink.sequenceplotter.SimplePlotUpdater
							-update-interval
							100
					-post-processor
						adams.flow.sink.sequenceplotter.PassThrough
			-actor
				adams.flow.sink.SequencePlotter
					-name
					Write
					-writer
						adams.gui.print.NullWriter
					-paintlet
						adams.gui.visualization.sequence.CirclePaintlet
					-overlay-paintlet
						adams.gui.visualization.sequence.LOWESSOverlayPaintlet
							-color
							#ff0000
							-window
							50
					-marker-paintlet
						adams.flow.sink.sequenceplotter.NoMarkers
					-error-paintlet
						adams.flow.sink.sequenceplotter.NoErrorPaintlet
					-mouse-click-action
						adams.flow.sink.sequenceplotter.NullClickAction
					-color-provider
						adams.gui.visualization.core.DefaultColorProvider
					-overlay-color-provider
						adams.gui.visualization.core.DefaultColorProvider
					-title
					Write
					-axis-x
						adams.gui.visualization.core.AxisPanelOptions
							-label
							evaluations
							-tick-generator
								adams.gui.visualization.core.axis.FancyTickGenerator
							-nth-value
							2
							-width
							40
							-custom-format
							0
					-axis-y
						adams.gui.visualization.core.AxisPanelOptions
							-label
							msec
							-tick-generator
								adams.gui.visualization.core.axis.FancyTickGenerator
							-nth-value
							2
							-width
							60
							-top-margin
							0.05
							-bottom-margin
							0.05
							-custom-format
							0
					-plot-updater
						adams.flow.sink.sequenceplotter.SimplePlotUpdater
							-update-interval
							100
					-post-processor
						adams.flow.sink.sequenceplotter.PassThrough
			-actor
				adams.flow.sink.Display
					-name
					Overall
					-writer
						adams.data.io.output.NullWriter
			-num-rows
			3
			-writer
				adams.gui.print.NullWriter
	-actor
		adams.flow.standalone.CallableActors
			-actor
				adams.flow.control.Sequence
					-name
					timing_write
					-actor
						adams.flow.control.ContainerValuePicker
							-value
							msec
							-switch-outputs
							true
					-actor
						adams.flow.transformer.MakePlotContainer
							-plot-name
							Write speed
					-actor
						adams.flow.sink.CallableSink
							-callable
							Write
			-actor
				adams.flow.control.Sequence
					-name
					timing_cpuspeed
					-actor
						adams.flow.control.ContainerValuePicker
							-value
							msec
							-switch-outputs
							true
					-actor
						adams.flow.transformer.MakePlotContainer
							-plot-name
							CPU Speed
					-actor
						adams.flow.sink.CallableSink
							-callable
							CPU
			-actor
				adams.flow.control.Sequence
					-name
					timing_overall
					-actor
						adams.flow.control.ContainerValuePicker
							-tee
								adams.flow.transformer.SetVariable
									-var-name
									msec
							-value
							msec
					-actor
						adams.flow.control.ContainerValuePicker
							-name
							ContainerValuePicker-1
							-tee
								adams.flow.transformer.SetVariable
									-var-name
									prefix
							-value
							Prefix
					-actor
						adams.flow.control.Trigger
							-name
							generate output
							-tee
								adams.flow.source.CombineVariables
									-expression
									Overall @{prefix}: @{msec} msec
							-tee
								adams.flow.sink.CallableSink
									-callable
									Overall
	-actor
		adams.flow.standalone.Standalones
			-name
			speed variables
			-actor
				adams.flow.standalone.SetVariable
					-name
					# means
					-var-name
					num_means
					-var-value
					25
			-actor
				adams.flow.standalone.SetVariable
					-name
					# stdevs
					-var-name
					num_stdevs
					-var-value
					25
			-actor
				adams.flow.standalone.SetVariable
					-name
					# data points
					-var-name
					num_points
					-var-value
					1000
	-actor
		adams.flow.standalone.Standalones
			-name
			write variables
			-actor
				adams.flow.standalone.SetVariable
					-name
					number of files
					-var-name
					num_files
					-var-value
					1000
			-actor
				adams.flow.standalone.SetVariable
					-name
					number of numbers per file
					-var-name
					num_rand
					-var-value
					1000
			-actor
				adams.flow.standalone.SetVariable
					-name
					output file
					-var-name
					outfile
					-var-value
					${TMP}/rand.txt
	-actor
		adams.flow.source.Start
	-actor
		adams.flow.control.TimedTrigger
			-name
			speed
			-tee
				adams.flow.source.ForLoop
					-upper
					@{num_means}
			-tee
				adams.flow.transformer.MathExpression
					-expression
					X / @{num_means}
			-tee
				adams.flow.transformer.SetVariable
					-var-name
					mean
			-tee
				adams.flow.control.Trigger
					-name
					mean
					-tee
						adams.flow.source.ForLoop
							-upper
							@{num_stdevs}
					-tee
						adams.flow.transformer.MathExpression
							-expression
							X / @{num_stdevs}
					-tee
						adams.flow.transformer.SetVariable
							-var-name
							stdev
					-tee
						adams.flow.control.TimedTrigger
							-name
							stdev
							-tee
								adams.flow.standalone.SetVariable
									-name
									plot name
									-var-name
									plot_name
									-var-value
									@{mean}/@{stdev}
									-expand-value
									true
							-tee
								adams.flow.source.ForLoop
									-lower
									0
									-upper
									@{num_points}
							-tee
								adams.flow.transformer.MathExpression
									-expression
									(X - (@{num_points} / 2)) / 33
							-tee
								adams.flow.transformer.MathExpression
									-name
									MathExpression-1
									-expression
									1/sqrt(2*PI*pow(@{stdev},2))*exp(-1*pow(X-@{mean},2)/(2*@{stdev}))
									-output-value-pair
									true
							-tee
								adams.flow.transformer.MakePlotContainer
									-skip
									true
									-plot-name
									@{plot_name}
							-tee
								adams.flow.sink.SequencePlotter
									-name
									Plot
									-skip
									true
									-writer
										adams.gui.print.NullWriter
									-paintlet
										adams.gui.visualization.sequence.LinePaintlet
									-overlay-paintlet
										adams.gui.visualization.sequence.NullPaintlet
									-marker-paintlet
										adams.flow.sink.sequenceplotter.NoMarkers
									-error-paintlet
										adams.flow.sink.sequenceplotter.NoErrorPaintlet
									-mouse-click-action
										adams.flow.sink.sequenceplotter.NullClickAction
									-color-provider
										adams.gui.visualization.core.DefaultColorProvider
									-overlay-color-provider
										adams.gui.visualization.core.DefaultColorProvider
									-axis-x
										adams.gui.visualization.core.AxisPanelOptions
											-label
											steps
											-tick-generator
												adams.gui.visualization.core.axis.FancyTickGenerator
											-nth-value
											2
											-width
											40
											-custom-format
											0
									-axis-y
										adams.gui.visualization.core.AxisPanelOptions
											-label
											msec
											-tick-generator
												adams.gui.visualization.core.axis.FancyTickGenerator
											-nth-value
											2
											-width
											60
											-custom-format
											0
									-plot-updater
										adams.flow.sink.sequenceplotter.SimplePlotUpdater
											-update-interval
											@{num_points}
									-post-processor
										adams.flow.sink.sequenceplotter.PassThrough
							-tee
								adams.flow.sink.SimplePlot
									-skip
									true
									-writer
										adams.gui.print.NullWriter
									-paintlet
										adams.gui.visualization.sequence.LinePaintlet
									-overlay-paintlet
										adams.gui.visualization.sequence.NullPaintlet
									-mouse-click-action
										adams.flow.sink.sequenceplotter.NullClickAction
									-color-provider
										adams.gui.visualization.core.DefaultColorProvider
									-axis-x
										adams.gui.visualization.core.AxisPanelOptions
											-label
											x
											-tick-generator
												adams.gui.visualization.core.axis.FancyTickGenerator
													-num-ticks
													20
											-nth-value
											2
											-width
											40
											-custom-format
											0.0
									-axis-y
										adams.gui.visualization.core.AxisPanelOptions
											-label
											y
											-tick-generator
												adams.gui.visualization.core.axis.FancyTickGenerator
											-nth-value
											2
											-width
											60
											-custom-format
											0.0
							-callable
							timing_cpuspeed
			-prefix
			CPU
			-callable
			timing_overall
	-actor
		adams.flow.control.TimedTrigger
			-name
			write
			-tee
				adams.flow.source.RandomNumberGenerator
					-generator
						adams.data.random.JavaRandomInt
					-max-num
					@{num_files}
			-tee
				adams.flow.transformer.Convert
					-conversion
						adams.data.conversion.DoubleToString
							-num-decimals
							0
							-fixed-decimals
							true
			-tee
				adams.flow.transformer.SetVariable
					-name
					set seed
					-var-name
					seed
			-tee
				adams.flow.control.Trigger
					-name
					delete file
					-tee
						adams.flow.source.Variable
							-var-name
							outfile
					-tee
						adams.flow.transformer.DeleteFile
			-tee
				adams.flow.control.Trigger
					-name
					generate random array
					-tee
						adams.flow.source.RandomNumberGenerator
							-generator
								adams.data.random.JavaRandomDouble
									-seed
									@{seed}
							-max-num
							@{num_rand}
					-tee
						adams.flow.transformer.SequenceToArray
							-length
							@{num_rand}
					-tee
						adams.flow.control.TimedTee
							-tee
								adams.flow.transformer.ArrayToSequence
							-tee
								adams.flow.sink.DumpFile
									-output
									${HOME}/temp/rand.txt
									-append
									true
							-callable
							timing_write
			-prefix
			Write
			-callable
			timing_overall
	-flow-execution-listener
		adams.flow.execution.NullListener

